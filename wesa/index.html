<!DOCTYPE HTML>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <title>Hello WESA</title>
    <link href="https://fonts.googleapis.com/css?family=Oxygen|Oxygen+Mono|Press+Start+2P" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="./css/style.css">
</head>

<body>

    <header>
        <div class="container" style="height:50px;"></div>
    </header>

    <div class="container">
    
        <div class="master-title-wrap">
            <h1 class="master-title font-pixel">WESA</h1>
            <h4 class="master-title-sub">A WebGL-based Engine of Sprite Animation</h4>
            <div class="short-hr"></div>
        </div>
       
        <div class="banner-demo-wrap">
            <p><img src="./assets/texture/megaman.png" /><code class="no-bg"> + wesa.js =</code></p>
            <canvas id="canvas" width="640" height="480"></canvas>
            <span class="in-canvas-display">Scroll inside canvas to change the sprite's "scale" property.<br />You may check the variable "s_Megaman" in your favorite developer tool.<br /><br />s_Megaman.scale = <span id="scale-value">4</span></span>
        </div>
        
        <div class="features-wrap">
            <div class="col">
                <h2>Simple and Light-weighted</h2>
                <p>Perhaps the simplest and easiest solution to turn your idea into old-school style, pixel-friendly sprite animations being displayed on the web.</p>
            </div>
            <div class="col">
                <h2>Free and Open-sourced</h2>
                <p><code>wesa.js</code> will always be fully open-sourced, for the sake of my personal interest of sprite animations.</p>
            </div>
        </div>
        
        <div class="content-wrap">
            <div class="paragraph">
                <h1>Why WESA?</h1>
                <p>You may consider to employ PixiJS or even ThreeJS if you need more, but WESA would be an elegant start point to learn to draw your favorite animated sprites on the screen.</p>
            </div>
            <div class="paragraph">
                <h1>Getting Started</h1>
                <p>Stay a while and <s>listen</s>learn the basic of <code>wesa.js</code>, see the documentation and check full code on GitHub.</p>
            </div>
            <div class="button-row">
                <a href="#" class="btn disabled"><i class="fa fa-cube"></i> Basic Concepts</a>
                <a href="#" class="btn disabled"><i class="fa fa-book"></i> Documentation</a>
                <a target="_blank" href="https://github.com/mriiiron/wesa" class="btn"><i class="fa fa-github"></i> Source Code</a>
            </div>
        </div>

    </div>

    <footer>
        <div class="container" style="height:400px;"></div>
    </footer>

    
    <script src="./js/lib/gl-matrix.min.js"></script>
    <script src="./js/wesa.js"></script>
    <script>
        
        var canvas = document.getElementById('canvas');
        var s_Megaman = null;
        var scaleValue = document.getElementById('scale-value');
        
        function onMouseWheel(e) {
            e.preventDefault();
            var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));
            s_Megaman.scale = (s_Megaman.scale + delta < 1 ? 1 : s_Megaman.scale + delta);
            scaleValue.textContent = s_Megaman.scale;
        }
        
        canvas.addEventListener("mousewheel", onMouseWheel);
        canvas.addEventListener("DOMMouseScroll", onMouseWheel);  // Firefox
        
        wesa.loader.loadImages([ './assets/texture/megaman.png' ]).done(function (images) {
        
            // Initialize WESA
            wesa.core.init(canvas);
        
            // Load sprite sheets
            {
                let ss = new wesa.SpriteSheet({
                    ssid: 0,
                    rowCount: 1,
                    colCount: 10,
                    cellWidth: 36,
                    cellHeight: 36
                });
                ss.loadTextureFromImage(wesa.core.handle.gl, images[0]);
                wesa.res.spriteSheetList[0] = ss;
            }
            
            // Load stored objects
            {
                let ssList = wesa.res.spriteSheetList;
                let obj = new wesa.StoredObject({
                    oid: 0,
                    type: 0,
                    name: 'Megaman'
                });
                let f = [
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 0, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 1, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 2, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 3, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 4, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 5, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 6, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 7, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 8, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    }),
                    new wesa.Frame({
                        spriteSheet: ssList[0],
                        cell: { row: 0, col: 9, rowSpan: 1, colSpan: 1 },
                        center: { x: 18, y: 18 }
                    })
                ];
                let anim = new wesa.Animation({
                    name: 'Running',
                    next: 0
                });
                anim.setFrames(
                    [f[0], f[1], f[2], f[3], f[4], f[5], f[6], f[7], f[8], f[9]],
                    [4, 4, 4, 4, 4, 4, 4, 4, 4, 4]
                );
                obj.addAnimation(0, anim);
                wesa.res.objectList[0] = obj;
            }
        
            // Create the scene
            var scene = new wesa.Scene('TestScene');
            s_Megaman = new wesa.Sprite({
                object: wesa.res.objectList[0],
                action: 0,
                team: 0,
                position: { x: 0, y: 0 },
                scale: 4
            });
            scene.addSpriteToLayer(0, s_Megaman);

            // Run the scene
            var animate = function () {
                requestAnimationFrame(animate);
                scene.update();
                scene.render();
            }
            animate();
        
        });
        

    </script>
    
</body>

</html>
